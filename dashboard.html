<!DOCTYPE html>
<html>
<head>
  <title>Your Feedbacks ðŸ’Œ</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <h1>Your Feedbacks ðŸ’Œ</h1>
  <button id="logoutBtn">Logout</button>
</header>

<div class="container">

  <div class="card">
    <div id="userInfo" class="muted">Checking login...</div>
  </div>

  <div class="card">
    <h2>Your feedback link</h2>
    <input id="bioLink" readonly>
    <button class="copy-btn" id="copyBtn">Copy link</button>
  </div>

  <div class="card">
  <h3>Messages</h3>
  <div id="list" class="messages">
    <div class="muted">Loading feedbacks...</div>
  </div>

</div>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { 
  getAuth, 
  onAuthStateChanged, 
  signOut 
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
import {
  getFirestore,
  collection,
  query,
  where,
  onSnapshot
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

/* ðŸ”‘ YOUR CONFIG (already correct) */
const firebaseConfig = {
  apiKey: "AIzaSyCviJWlQvukpfikmHOG-GoAvAnzTBRt8OI",
  authDomain: "cutie-feedback.firebaseapp.com",
  projectId: "cutie-feedback"
};

/* INIT */
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

/* DOM */
const userInfo = document.getElementById("userInfo");
const bioLink = document.getElementById("bioLink");
const list = document.getElementById("list");

/* âœ… AUTH CHECK */
onAuthStateChanged(auth, (user) => {
  if (!user) {
    window.location.href = "login.html";
    return;
  }

  // show user
  userInfo.innerHTML = `Logged in as <strong>${user.email}</strong>`;

  // bio link
  const link =
    "https://sayitcutie.github.io/feedback/index.html?uid=" +
    user.uid;

  bioLink.value = link;

  document.getElementById("copyBtn").onclick = () => {
    navigator.clipboard.writeText(link);
    alert("Link copied ðŸ’–");
  };

  // ðŸ”¥ NOW LOAD FEEDBACKS
  loadFeedbacks(user.uid);
});

/* LOAD FEEDBACKS */
function loadFeedbacks(uid) {
const q = query(
  collection(db, "feedbacks"),
  where("ownerUid", "==", uid),
  orderBy("createdAt", "desc")
);

  onSnapshot(q, (snap) => {
    list.innerHTML = "";

    if (snap.empty) {
      list.innerHTML = `<div class="muted">No feedback yet ðŸ¥º</div>`;
      return;
    }

    snap.forEach((doc) => {
      const div = document.createElement("div");
      div.className = "message";
      div.textContent = doc.data().text;
      list.appendChild(div);
    });
  });
}
import {
  collection,
  query,
  where,
  orderBy,
  onSnapshot
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

/* LOGOUT */
document.getElementById("logoutBtn").onclick = () => {
  signOut(auth);
};
</script>
</body>
</html>